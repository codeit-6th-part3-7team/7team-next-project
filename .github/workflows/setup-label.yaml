name: Setup Labels

on:
  workflow_dispatch:

jobs:
  setup-labels:
    runs-on: ubuntu-latest
    steps:
      - name: Setup Default Labels
        uses: actions/github-script@v5
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const labels = [
              { name: "Priority: High ğŸ”¥", description: 'ìš°ì„ ìˆœìœ„ ë†’ìŒ', color: "F9D0C4" },
              { name: "Priority: Low ğŸ¢", description: 'ìš°ì„ ìˆœìœ„ ë‚®ìŒ', color: "C2E0C6" },
              { name: "Priority: Medium :bookmark:", description: 'ìš°ì„ ìˆœìœ„ ë³´í†µ', color: "FEF2C0" },
              { name: "Type: Doc :memo:", description: 'ë¬¸ì„œ ì¶”ê°€ / ìˆ˜ì •', color: "0075ca" },
              { name: "Type: Bug :bug:", description: 'ë²„ê·¸', color: "d73a4a" },
              { name: "Type: Epic :rocket:", description: 'í° ë‹¨ìœ„ì˜ ë¸Œëœì¹˜', color: "051C35" },
              { name: "Type: Feature :sparkles:", description: 'ì‹ ê·œ ê¸°ëŠ¥', color: "AB5D19" },
              { name: "Type: Improve UX :arrow_up:", description: 'UX ê°œì„ ', color: "2CE151" },
              { name: "Type: Merge :truck:", description: 'ë¨¸ì§€', color: "4A7A8F" },
              { name: "Type: Refactor :recycle:", description: 'ë¦¬íŒ©í† ë§', color: "027B6B" },
            ];  

            // ì¡´ì¬í•˜ëŠ” ëª¨ë“  ë ˆì´ë¸” ë‚˜ì—´
            const listResponse = await github.rest.issues.listLabelsForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
            });

            // ë‚˜ì—´ëœ ê° ë ˆì´ë¸”ì— ëŒ€í•´ ì‚­ì œ ìš”ì²­
            for (const label of listResponse.data) {
              await github.rest.issues.deleteLabel({
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: label.name,
              });

              console.log(`Label '${label.name}' deleted.`);
            }

            // ìƒˆë¡œìš´ ë ˆì´ë¸” ìƒì„±
            for (const label of labels) {
              const response = await github.rest.issues.createLabel({
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: label.name,
                color: label.color,
                description: label.description,
              });

              console.log(`Label ${label.name} processed`, response.status);
            }